<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PontoView • Orientações</title>

  <!-- Inter -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800;900&display=swap" rel="stylesheet">

  <!-- Material Icons Outlined -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet" />

  <!-- SEU CSS (na pasta /css) -->
  <link rel="stylesheet" href="css/pv-base.css">

  <!-- CSS mínimo só do painel (mensagem + progress + offline overlay) -->
  <style>
    /* Mantém o padrão do base, só garante que o card vire “palco” do overlay */
    .pvCard{ position:relative; display:flex; flex-direction:column; min-height:0; }

    .pvCardHeader{
      padding: calc(var(--pad) * .62) var(--pad);
      border-bottom:1px solid var(--line);
      background: linear-gradient(180deg, rgba(10,34,50,.04), rgba(10,34,50,0));
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      flex:0 0 auto;
      min-width:0;
    }
    .pvCardHeader .label{
      font-size: var(--t-sub);
      font-weight: 900;
      letter-spacing: .12em;
      text-transform: uppercase;
      color:#1f2a44;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .pvHeaderDots{
      display:flex; align-items:center; gap:6px; flex:0 0 auto;
    }
    .pvHeaderDots span{
      width:10px;height:10px;border-radius:999px;
      background: rgba(15,23,42,.12);
    }
    .pvHeaderDots span.active{
      width:22px; background:#2c6aa3;
    }

    .pvCardBody{
      flex:1 1 auto;
      min-height:0;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: calc(var(--pad) * 1.15);
      overflow:hidden;
    }

    .pvMsgBox{ width:min(1200px, 92%); text-align:center; }
    .pvMsgPrimary{
      margin:0;
      font-weight: 900;
      color: var(--ink);
      font-size: clamp(30px, 4.2vw, 60px);
      line-height: 1.08;
      letter-spacing: -0.02em;
      opacity: 1;
      transform: translateY(0);
      filter: blur(0px);
      transition: opacity 520ms ease, transform 520ms ease, filter 520ms ease;
    }
    .pvMsgSecondary{
      margin: 12px 0 0;
      font-weight: 900;
      letter-spacing: .12em;
      text-transform: uppercase;
      color: #3b4b62;
      font-size: clamp(12px, 1.8vw, 18px);
      opacity: .72;
      transition: opacity 520ms ease, transform 520ms ease, filter 520ms ease;
    }

    /* Estado de troca */
    .pvFadeOut .pvMsgPrimary,
    .pvFadeOut .pvMsgSecondary{
      opacity: 0;
      transform: translateY(6px);
      filter: blur(1px);
    }

    /* Progress */
    .pvProgressWrap{
      width:min(900px, 72%);
      margin: 18px auto 0;
      padding: 8px 10px;
      border-radius:999px;
      background: #f6f8fc;
      border:1px solid rgba(15,23,42,.08);
    }
    .pvProgress{
      height: 8px;
      border-radius:999px;
      background: rgba(15,23,42,.10);
      overflow:hidden;
    }
    .pvBar{
      height:100%;
      width:0%;
      border-radius:999px;
      background:#2c6aa3;
    }

    /* ===== OFFLINE OVERLAY (fallback dentro do mesmo painel) ===== */
    .pvOffline{
      position:absolute;
      inset:0;
      display:none;            /* aparece via JS */
      align-items:center;
      justify-content:center;
      padding: var(--pad);
      background: rgba(255,255,255,.92);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      z-index: 5;
    }
    .pvOfflineCard{
      width: min(980px, 92%);
      border-radius: 18px;
      border:1px solid var(--line);
      background:#fff;
      box-shadow: 0 14px 40px rgba(0,0,0,.10);
      padding: clamp(18px, 2.2vw, 30px);
      display:flex;
      gap: 18px;
      align-items:flex-start;
    }
    .pvOfflineIcon{
      width: 54px; height: 54px;
      border-radius: 16px;
      background: rgba(239,68,68,.10);
      border:1px solid rgba(239,68,68,.25);
      display:grid;
      place-items:center;
      flex:0 0 auto;
    }
    .pvOfflineIcon .material-icons-outlined{
      font-size: 28px;
      color:#ef4444;
      opacity:.95;
    }
    .pvOfflineTitle{
      margin:0;
      font-weight: 900;
      letter-spacing:.08em;
      text-transform: uppercase;
      font-size: clamp(16px, 1.6vw, 22px);
      color:#0f172a;
    }
    .pvOfflineText{
      margin:10px 0 0;
      color:#334155;
      font-weight:700;
      font-size: clamp(14px, 1.5vw, 18px);
      line-height:1.35;
      opacity:.9;
    }
    .pvOfflineHint{
      margin:10px 0 0;
      color:#475569;
      font-weight:800;
      font-size: clamp(12px, 1.2vw, 14px);
      letter-spacing:.08em;
      text-transform: uppercase;
      opacity:.75;
    }

    @media (prefers-reduced-motion: reduce){
      .pvMsgPrimary, .pvMsgSecondary{ transition:none; }
      .pvBar{ transition:none !important; }
    }
  </style>
</head>

<body>
  <div class="pvPage">
    <div class="pvShell" role="application" aria-label="Painel PontoView Orientações">

      <!-- Header padrão -->
      <header class="pvHeader">
        <div class="pvHeaderLeft">
          <div class="pvIconBadge" aria-hidden="true">
            <span class="material-icons-outlined">info</span>
          </div>
          <div class="pvTitles">
            <h1 class="pvTitle">ORIENTAÇÕES</h1>
          </div>
        </div>

        <div class="pvHeaderRight" aria-label="Horário">
          <div class="pvClock" id="clock">--:--</div>
        </div>
      </header>

      <!-- Subbar padrão -->
      <div class="pvSubbar">
        <div class="pvSubLeft">BOAS PRÁTICAS</div>
        <div class="pvSubRight">
          <span class="pvPill" title="Status de conexão">
            <span class="pvDot" id="netDot" aria-hidden="true"></span>
            <span id="netText">ONLINE</span>
          </span>
        </div>
      </div>

      <!-- Content padrão -->
      <main class="pvContent">
        <section class="pvCard" aria-label="Cartão de orientações" id="card">

          <div class="pvCardBody" id="stage">
            <div class="pvMsgBox">
              <p class="pvMsgPrimary" id="msgPrimary">Aguarde ser chamado</p>
              <p class="pvMsgSecondary" id="msgSecondary">Acompanhe as informações exibidas neste painel</p>

              <div class="pvProgressWrap" aria-hidden="true">
                <div class="pvProgress"><div class="pvBar" id="bar"></div></div>
              </div>
            </div>
          </div>

          <!-- FALLBACK OFFLINE (fica dentro do mesmo pvCard) -->
          <div class="pvOffline" id="offlineLayer" aria-hidden="true">
            <div class="pvOfflineCard" role="status" aria-label="Modo offline">
              <div class="pvOfflineIcon" aria-hidden="true">
                <span class="material-icons-outlined">wifi_off</span>
              </div>
              <div>
                <p class="pvOfflineTitle">MODO OFFLINE</p>
                <p class="pvOfflineText">
                  Sem conexão com a internet no momento. O painel continuará exibindo informações locais e será retomado automaticamente quando a conexão voltar.
                </p>
                <p class="pvOfflineHint">verificando conexão…</p>
              </div>
            </div>
          </div>

        </section>
      </main>

      <!-- Footer padrão -->
      <footer class="pvFooter" aria-label="Rodapé">
        
        <div class="pvFooterRight">
          <img class="pvLogo" src="assets/logo-pontoview.png" alt="PontoView" onerror="this.style.display='none'">
        </div>
      </footer>

    </div>
  </div>

  <script>
    /***********************
     * CONFIG
     ***********************/
    const ROTATE_EVERY_MS = 20000;
    const TRANSITION_MS = 520;
    const SECONDARY_MODE = "rotate"; // "static" | "none" | "rotate"
    const SECONDARY_STATIC_TEXT = "Acompanhe as informações exibidas neste painel";

    const ORIENTACOES = [
      "Respeite a ordem de atendimento",
      "Aguarde ser chamado",
      "Em caso de dúvidas, procure um atendente",
      "Mantenha seus dados atualizados",
      "Confira as informações exibidas no local",
      "Atenção aos avisos disponíveis neste ambiente",
      "Mantenha o ambiente organizado",
      "Respeite o espaço das outras pessoas",
      "Evite falar ao celular em voz alta",
      "Mantenha o volume do celular no modo silencioso",
      "Colabore para um ambiente mais agradável",
      "Seja gentil e paciente",
      "Cuide de seus pertences pessoais",
      "Este ambiente pode ser monitorado",
      "Atenção à sinalização do local",
      "Em caso de emergência, siga as orientações da equipe",
      "Mantenha as áreas de circulação livres",
      "Evite correr em áreas internas",
      "Higienize as mãos sempre que possível",
      "Utilize álcool em gel quando disponível",
      "Caso não se sinta bem, informe um responsável",
      "Colabore com as medidas de segurança do local",
      "Respeito é fundamental para uma boa convivência",
      "A colaboração de todos faz a diferença",
      "Pequenas atitudes tornam o ambiente melhor",
      "Sua compreensão é importante"
    ];

    const SECONDARIAS = [
      "Obrigado por colaborar.",
      "Sua atenção faz a diferença.",
      "Siga a sinalização do local.",
      "Em caso de dúvida, procure a equipe.",
      "Aguarde as próximas informações."
    ];

    /***********************
     * ELEMENTOS
     ***********************/
    const stage = document.getElementById("stage");
    const msgPrimary = document.getElementById("msgPrimary");
    const msgSecondary = document.getElementById("msgSecondary");
    const bar = document.getElementById("bar");
    const clockEl = document.getElementById("clock");
    const updatedEl = document.getElementById("updated");

    const netDot = document.getElementById("netDot");
    const netText = document.getElementById("netText");
    const offlineLayer = document.getElementById("offlineLayer");

    /***********************
     * UTIL
     ***********************/
    const pad2 = (n) => String(n).padStart(2, "0");

    function formatClock(d){
      return `${pad2(d.getHours())}:${pad2(d.getMinutes())}`;
    }
    function formatUpdated(d){
      return `ATUALIZADO • ${pad2(d.getDate())}/${pad2(d.getMonth()+1)}, ${formatClock(d)}`;
    }
    function shuffle(arr){
      const a = arr.slice();
      for(let i=a.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i],a[j]] = [a[j],a[i]];
      }
      return a;
    }

    /***********************
     * CLOCK + UPDATED
     ***********************/
    function tick(){
      const d = new Date();
      clockEl.textContent = formatClock(d);
      updatedEl.textContent = formatUpdated(d);
    }
    tick();
    setInterval(tick, 1000);

    /***********************
     * ROTATION
     ***********************/
    let pool = shuffle(ORIENTACOES);
    let idx = 0;
    let lastText = null;

    function nextText(){
      if(idx >= pool.length){
        pool = shuffle(ORIENTACOES);
        idx = 0;
      }
      let t = pool[idx++];
      if(t === lastText && pool.length > 1){
        if(idx >= pool.length){ pool = shuffle(ORIENTACOES); idx = 0; }
        t = pool[idx++];
      }
      lastText = t;
      return t;
    }

    function pickSecondary(){
      if(SECONDARY_MODE === "none") return "";
      if(SECONDARY_MODE === "static") return SECONDARY_STATIC_TEXT;
      return SECONDARIAS[Math.floor(Math.random()*SECONDARIAS.length)];
    }

    function startProgress(){
      bar.style.transition = "none";
      bar.style.width = "0%";
      bar.offsetHeight;
      bar.style.transition = `width ${ROTATE_EVERY_MS}ms linear`;
      bar.style.width = "100%";
    }

    function setMessage(primary, secondary){
      stage.classList.add("pvFadeOut");
      setTimeout(() => {
        msgPrimary.textContent = primary;

        const sec = (secondary || "").trim();
        if(sec){
          msgSecondary.style.display = "";
          msgSecondary.textContent = sec;
        }else{
          msgSecondary.style.display = "none";
        }

        stage.classList.remove("pvFadeOut");
      }, TRANSITION_MS);
    }

    function rotateOnce(){
      setMessage(nextText(), pickSecondary());
      startProgress();
    }

    setMessage(nextText(), pickSecondary());
    startProgress();
    setInterval(rotateOnce, ROTATE_EVERY_MS);

    /***********************
     * FALLBACK OFFLINE (no mesmo painel)
     ***********************/
    function setOnlineUI(isOnline){
      // Pill
      netText.textContent = isOnline ? "ONLINE" : "OFFLINE";
      if(isOnline){
        netDot.classList.remove("off");
      }else{
        netDot.classList.add("off");
      }

      // Overlay
      offlineLayer.style.display = isOnline ? "none" : "flex";
      offlineLayer.setAttribute("aria-hidden", isOnline ? "true" : "false");
    }

    // Estado inicial
    setOnlineUI(navigator.onLine);

    // Eventos do browser
    window.addEventListener("online",  () => setOnlineUI(true));
    window.addEventListener("offline", () => setOnlineUI(false));

    // “Sanidade”: checagem periódica (evita ficar preso em estado errado em algumas TVs)
    setInterval(() => {
      setOnlineUI(navigator.onLine);
    }, 5000);
  </script>
</body>
</html>
